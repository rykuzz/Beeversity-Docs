<template>
    <lightning-card title="Ringkasan Kualitas Lead (Aktif)" icon-name="utility:chart">
        <div class="slds-p-around_medium">
            <if:true if:true={isLoading}>
                <lightning-spinner alternative-text="Loading..." size="medium"></lightning-spinner>
            </if:true>

            <if:true if:true={error}>
                <p>Terjadi kesalahan saat memuat data.</p>
            </if:true>

            <if:true if:true={summaryData}>
                <div class="slds-align_absolute-center slds-text-align_center slds-m-bottom_medium">
                    <div>
                        <p class="slds-text-title">SKOR RATA-RATA</p>
                        <p class="slds-text-heading_large" style="font-weight:700;">{summaryData.averageScore}%</p>
                        <p><lightning-badge label={rating}></lightning-badge></p>
                    </div>
                </div>

                <div class="slds-box slds-theme_shade slds-m-bottom_medium">
                    <p><b>Distribusi dari {summaryData.totalLeads} Leads:</b></p>
                    <ul class="slds-list_dotted">
                        <li>Luar Biasa (&gt;=90%): {summaryData.greatLeadsCount} Leads</li>
                        <li>Baik (70-89%): {summaryData.goodLeadsCount} Leads</li>
                        <li>Perlu Perhatian (&lt;70%): {summaryData.poorLeadsCount} Leads</li>
                    </ul>
                </div>
                
                <h3 class="slds-text-heading_small slds-m-bottom_small">
                    <lightning-icon icon-name="utility:warning" size="small" variant="warning"></lightning-icon>
                    <span class="slds-m-left_x-small">Perlu Tindakan Segera</span>
                </h3>
                <lightning-datatable
                    key-field="id"
                    data={paginatedPoorLeads} columns={columns}
                    hide-checkbox-column="true"
                    show-row-number-column="false">
                </lightning-datatable>
                
                <div if:true={summaryData.poorLeads.length} class="slds-grid slds-grid_vertical-align-center slds-m-top_medium">
                    <div class="slds-col">
                        <lightning-button 
                            label="Sebelumnya" 
                            icon-name="utility:chevronleft" 
                            onclick={handlePrevious} 
                            disabled={isFirstPage}>
                        </lightning-button>
                    </div>
                    <div class="slds-col slds-text-align_center">
                        <span>{paginationLabel}</span>
                    </div>
                    <div class="slds-col slds-text-align_right">
                        <lightning-button 
                            label="Berikutnya" 
                            icon-name="utility:chevronright" 
                            icon-position="right" 
                            onclick={handleNext} 
                            disabled={isLastPage}>
                        </lightning-button>
                    </div>
                </div>

            </if:true>
        </div>
    </lightning-card>
</template>